---
title: "Passwords"
output: html_notebook
keep_md: TRUE
---

```{r}
library(tidyverse)
library(stringi)
library(janitor)
```


```{r}
babynames %>% 
  filter(name == "Gunther" & sex == "M") 
```

```{r}
passwords <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-01-14/passwords.csv')
```

```{r}
passwords %>% 
  drop_na()
```

```{r}
#1st line from top
df1=data.frame(xmin=c(0,1,2,3,4,5,6,7,8,9,10,11,12,13),
              xmax=c(1,2,3,4,5,6,7,8,9,10,11,12,13,15),
              ymin=rep(4,14),
              ymax=rep(5,14),
              value=c("'","1","2","3","4","5","6","7","8","9","0","-","=","backspace"))
#2nd line from top
df2=data.frame(xmin=c(0,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,10.5,11.5,12.5,13.5),
               xmax=c(1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,10.5,11.5,12.5,13.5,15),
               ymin=rep(3,14),
               ymax=rep(4,14),
               value=c("tab","Q","W","E","R","T","Y","U","I","O","P","[","]","enter"))
#3rd line from top
df3=data.frame(xmin=c(0,1.75,2.75,3.75,4.75,5.75,6.75,7.75,8.75,9.75,10.75,11.75,12.75,13.75),
               xmax=c(1.75,2.75,3.75,4.75,5.75,6.75,7.75,8.75,9.75,10.75,11.75,12.75,13.75,15),
               ymin=rep(2,14),
               ymax=rep(3,14),
               value=c("caps","A","S","D","F","G","H","J","K","L",":","@","~","enter"))
#4th line from top
df4=data.frame(xmin=c(0,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,10.5,11.5,12.5),
               xmax=c(1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,10.5,11.5,12.5,15),
               ymin=rep(1,13),
               ymax=rep(2,13),
               value=c("shiftr","|","Z","X","C","V","B","N","M","<",">","?","shiftr"))
#5th line from top
df5=data.frame(xmin=c(0,1.5,2.5,4,10,11.5,12.5,13.5),
               xmax=c(1.5,2.5,4,10,11.5,12.5,13.5,15),
               ymin=rep(0,8),
               ymax=rep(1,8),
               value=c("ctrll","winl","altl","space","altgr","winr","menu","ctrlr"))

#putting it together
df=rbind(df1,df2,df3,df4,df5)

ggplot(df,aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax))+
  geom_rect(colour="black")+geom_text(aes(x=(xmin+xmax)/2,y=(ymin+ymax)/2,label=value))+
  theme_void()
```

```{r}
library(ggplot2)
#1st line from top
df1=data.frame(xmin=c(0,1,2,3,4,5,6,7,8,9,10,11,12,13),
              xmax=c(1,2,3,4,5,6,7,8,9,10,11,12,13,15),
              ymin=rep(4,14),
              ymax=rep(5,14),
              value=c("'","1","2","3","4","5","6","7","8","9","0","-","="))
#2nd line from top
df2=data.frame(xmin=c(0,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,10.5,11.5,12.5,13.5),
               xmax=c(1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,10.5,11.5,12.5,13.5,15),
               ymin=rep(3,14),
               ymax=rep(4,14),
               value=c("Q","W","E","R","T","Y","U","I","O","P","[","]"))
#3rd line from top
df3=data.frame(xmin=c(0,1.75,2.75,3.75,4.75,5.75,6.75,7.75,8.75,9.75,10.75,11.75,12.75,13.75),
               xmax=c(1.75,2.75,3.75,4.75,5.75,6.75,7.75,8.75,9.75,10.75,11.75,12.75,13.75,15),
               ymin=rep(2,14),
               ymax=rep(3,14),
               value=c("A","S","D","F","G","H","J","K","L",":","@","~"))
#4th line from top
df4=data.frame(xmin=c(0,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,10.5,11.5,12.5),
               xmax=c(1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,10.5,11.5,12.5,15),
               ymin=rep(1,13),
               ymax=rep(2,13),
               value=c("|","Z","X","C","V","B","N","M","<",">","?"))


#putting it together
df=rbind(df1,df2,df3,df4)

ggplot(df,aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax))+
  geom_rect(colour="black")+geom_text(aes(x=(xmin+xmax)/2,y=(ymin+ymax)/2,label=value))+
  theme_void()
```

```{r}
order <- c(10, seq(1,9), )

x <- c(seq(1,10), seq(2,11), seq(3,11), seq(4,10))

# x <- c(seq(1,10), seq(1.5,10.5), seq(2,11), seq(2.5,9.5))

y <- c(rep(4, times = 10), rep(3, times = 10), rep(2, times = 9), rep(1, times = 7))

order <- c("1", "2", "3", "4", "5", "6", "7", "8", "9", "0", "q", "w", "e", "r", "t", "y", "u", "i", "o", "p", "a", "s", "d", "f", "g", "h", "j", "k", "l", "z", "x", "c", "v", "b", "n", "m")

order2 <- c(seq(1,36))

order <- enframe(order) %>% 
  select(value) %>% 
  add_column(order = order2)

freq <- passwords %>% 
  pull(password) %>% 
  strsplit(split = "") %>% 
  unlist() %>% 
  table() %>% 
  as.tibble() %>% 
  clean_names() %>%
  rename("character" = x) %>% 
  left_join(order, by = c("character" = "value")) %>% 
  arrange(order) %>% 
  add_column(x = x, y = y)
```

```{r}
ggplot(freq,aes(x, y))+
  geom_tile(aes(x, y, fill = n))+
  geom_text(aes(label = character), color = "white")+
  theme_void()+
  labs(title = "Which keys are the most popular for passwords on a keyboard?")
```

```{r}
left_join(freq, order, by = c("character" = "value"))
```

